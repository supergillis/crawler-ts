# crawler-ts

<p align="center">
  Crawler written in TypeScript using ES6 generators.
</p>

<p align="center">
  <a href="https://www.npmjs.com/package/crawler-ts">
    <img alt="npm" src="https://img.shields.io/npm/v/crawler-ts.svg?color=green"/>
  </a>
  <a href="https://bundlephobia.com/result?p=crawler-ts">
    <img alt="bundle size" src="https://img.shields.io/bundlephobia/minzip/crawler-ts?label=bundle size"/>
  </a>
  <img alt="license" src="https://img.shields.io/npm/l/crawler-ts?label=license&color=green"/>
</p>

## Installation

```sh
npm install --save crawler-ts crawler-ts-htmlparser2
```

## Examples

- [Crawl the file system](./examples/fs/src/index.ts)
- [Crawl Github](./examples/http/src/index.ts)

## API

The `crawl` function expects the following configuration as the first parameter.

```typescript
/**
 * @type {Location} The type of the locations to crawl, e.g. `URL` or `string` that represents a path.
 * @type {Response} The type of the response at the location that is crawler, e.g. Cheerio object, file system `fs.Stats`.
 * @type {Result} The intermediate result that can be parsed from the response and generated by the crawler.
 */
export interface Config<Location, Response, Result> {
  /**
   * This function should return the response for the given location.
   */
  requester(loc: Location): Response | Promise<Response | undefined>;
  /**
   * This function should return true if the crawler should parse the response, or false if not.
   */
  shouldParse(loc: Location, response: Response): boolean | Promise<boolean>;
  /**
   * This function should parse the response and convert the response to the result type.
   */
  parser(loc: Location, response: Response): Result | Promise<Result | undefined>;
  /**
   * This function should return true if the crawler should yield the result, or false if not.
   */
  shouldYield(result: Result): boolean | Promise<boolean>;
  /**
   * This function should yield all the locations to follow in the given result.
   */
  follower(result: Result): AsyncGenerator<Location>;
  /**
   * This function should return true if the crawler should queue the location for crawling, or false if not.
   */
  shouldQueue(loc: Location): boolean | Promise<boolean>;
  /**
   * The logger can be set to `console` to output debug information to the `console`.
   *
   * @default undefined
   */
  logger?: Logger;
}
```

There are built-in modules available that implement some of these configuration values. See [Modules](.#modules) section.

## Modules

### crawler-ts-fetch

<p>
  <a href="https://www.npmjs.com/package/crawler-ts-fetch">
    <img alt="npm" src="https://img.shields.io/npm/v/crawler-ts-fetch.svg?color=green"/>
  </a>
  <a href="https://bundlephobia.com/result?p=crawler-ts-fetch">
    <img alt="bundle size" src="https://img.shields.io/bundlephobia/minzip/crawler-ts-fetch?label=bundle size"/>
  </a>
</p>

This module implements a requester that uses `node-fetch` to request content over HTTP.

See [modules/crawler-ts-fetch](./modules/crawler-ts-fetch).

### crawler-ts-htmlparser2

<p>
  <a href="https://www.npmjs.com/package/crawler-ts-htmlparser2">
    <img alt="npm" src="https://img.shields.io/npm/v/crawler-ts-htmlparser2.svg?color=green"/>
  </a>
  <a href="https://bundlephobia.com/result?p=crawler-ts-htmlparser2">
    <img alt="bundle size" src="https://img.shields.io/bundlephobia/minzip/crawler-ts-htmlparser2?label=bundle size"/>
  </a>
</p>

This module implements a requester, parser and follower for HTML. The requester uses `crawler-ts-fetch` to request content over HTTP. The parser uses `htmlparser2` to parse HTML files. The follower uses the parser result to find `<a>` anchor elements and yields its `href` properties.

See [modules/crawler-ts-htmlparser2](./modules/crawler-ts-htmlparser2).

## Author

Gillis Van Ginderachter

## License

GNU General Public License v3.0
